<html>

<head>

  <script src="https://io-chat-serve.herokuapp.com/socket.io/socket.io.js" type="text/javascript"></script>

  <script>


    // ws.onmessage = (event) => {
    //   var item = document.createElement('li');
    //   item.textContent = event.data;
    //   console.log(event.data);
    //   messages.appendChild(item);
    //   window.scrollTo(0, document.body.scrollHeight);
    // };



  </script>
</head>

<body>
  <p id="server-time"></p>

  <ul id="messages"></ul>
  <form id="form">
    <input id="input" autocomplete="off" />
  </form>
  <button type="button">Send</button>
  <script>

    user = prompt('enter your name');

    const socket = io('https://io-chat-serve.herokuapp.com', { query: 'loggeduser=' + user }, {
      withCredentials: true,
      extraHeaders: {
        "my-custom-header": "abcd",
        'user': user
      },
    });

    let el;

   

    //reciver

    socket.on('time', (timeString) => {
      el = document.getElementById('server-time');
      el.innerHTML = 'Server time: ' + timeString;
    });

    socket.on('join_user', (user) => {
      var item = document.createElement('li');
      item.textContent = user.user + " : joined";
      console.log(user);
      messages.appendChild(item);
      window.scrollTo(0, document.body.scrollHeight);
    });

    socket.on('message', (message) => {
      var item = document.createElement('li');
      item.textContent = "user  : " + message;
      console.log(user);
      messages.appendChild(item);
      window.scrollTo(0, document.body.scrollHeight);
    });




    // sender

    var messages = document.getElementById('messages');
    var form = document.getElementById('form');
    var input = document.getElementById('input');
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      if (input.value) {


        input.value = '';
      }
    });
  </script>

</body>

</html>